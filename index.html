<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine Mini-Game Upgraded</title>
<style>
body {
  margin:0; padding:0;
  font-family:'Comic Sans MS', cursive;
  background: linear-gradient(135deg, #ffdee9, #b5fffc, #fddde6);
  overflow:hidden;
  height:100vh;
  position:relative;
}

/* Card styling */
.card {
  position:absolute;
  top:50%; left:50%;
  transform: translate(-50%,-50%);
  width:480px; padding:30px;
  background:#ffe6f0; border-radius:25px;
  box-shadow:0 10px 30px rgba(0,0,0,0.2);
  text-align:center;
  z-index:2;
  transition: transform 0.3s ease;
}
.card h1 { font-size:1.6rem; margin-bottom:10px; }
.card p { font-size:1.2rem; margin-bottom:20px; }

/* Button container */
.button-container {
  position:relative;
  width:100%;
  height:80px;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:30px;
}

.button-container button {
  font-size:1rem;
  padding:12px 30px;
  border:none;
  border-radius:18px;
  cursor:pointer;
  position:absolute;
  transition: transform 0.2s ease, background 0.3s ease, box-shadow 0.3s ease;
}

/* YES button */
#yesBtn, #yesBtnMini {
  background: linear-gradient(45deg,#ff8ec7,#b57fff);
  color:white;
  box-shadow:0 5px 15px rgba(0,0,0,0.3);
  z-index:5;
  left:30%;
  top:10px;
}
#yesBtn.magical, #yesBtnMini.magical {
  animation: yesFloat 2s ease-in-out infinite, glowPulse 2s infinite;
}

/* NO button */
#noBtn, #noBtnMini {
  background:#ffcce0; color:#800040;
  box-shadow:0 5px 10px rgba(0,0,0,0.2);
  z-index:5;
  left:70%;
  top:10px;
}

/* Glitch Animation */
@keyframes glitch {
  0% { text-shadow: 2px 0 #ff0000; transform: translate(0); }
  20% { text-shadow: -2px 0 #00ffff; transform: translate(-2px, 1px); }
  100% { text-shadow: 0; transform: translate(0); }
}
.glitch-active { animation: glitch 0.2s linear; background: #ff4d94 !important; }

/* YES button animations */
@keyframes yesFloat {
  0% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0px); }
}
@keyframes glowPulse {
  0% { box-shadow:0 0 10px #ff8ec7; }
  50% { box-shadow:0 0 20px #b57fff; }
  100% { box-shadow:0 0 10px #ff8ec7; }
}

/* Proceed button animation */
@keyframes proceedAnim {
  0% { transform: scale(1) rotate(0deg); }
  25% { transform: scale(1.1) rotate(5deg); }
  50% { transform: scale(1) rotate(-5deg); }
  75% { transform: scale(1.1) rotate(3deg); }
  100% { transform: scale(1) rotate(0deg); }
}

/* Heart collectibles */
.heart {
  position:absolute;
  font-size:40px;
  cursor:pointer;
  user-select:none;
  transition: transform 0.2s ease;
  z-index:3;
  pointer-events:auto;
  padding:10px;
  display:flex;
  align-items:center;
  justify-content:center;
  opacity: 1 !important; 
}

/* Heart pop animation */
@keyframes heartPop {
  0% { transform: scale(1); }
  50% { transform: scale(1.6); }
  100% { transform: scale(1); opacity:0; }
}

/* Envelope */
#envelope {
  font-size:90px;
  cursor:pointer;
  transition: transform 0.5s ease;
}
#envelope.locked { filter: grayscale(80%); }

/* Floating emojis */
.floating-emoji {
  position:absolute;
  pointer-events:none;
  font-size:40px;
  opacity:0.9;
  z-index:1;
}

/* Slideshow */
#slideshow {
  position:absolute; top:0; left:0; width:100%; height:100%;
  background:linear-gradient(135deg, #ffdee9, #b5fffc, #fddde6);
  display:flex; justify-content:center; align-items:center;
  text-align:center; font-size:2rem; color:#800040;
  z-index:10;
  flex-direction:column;
}

.slide { display:none; opacity:0; transition: opacity 0.6s ease; }
.slide.active { display:flex; opacity:1; flex-direction:column; justify-content:center; align-items:center; }

.slide-footer { font-size:0.8rem; margin-top:20px; opacity:0.7; }
#proceedToGame { margin-top:20px; font-size:1rem; padding:10px 20px; border-radius:15px; cursor:pointer; background:linear-gradient(45deg,#ff8ec7,#b57fff); color:white; border:none; animation: proceedAnim 1.2s ease-in-out infinite; }
</style>
</head>
<body>

<div id="slideshow">
  <div class="slide active" id="slide1"><p>Hello, Lovely Lady ğŸ˜</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide2"><p>Before you continueâ€¦</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide3"><p>Take a deep breath.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide4"><p>Because what youâ€™re about to readâ€¦</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide5"><p>â€¦is very important.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide6"><p>Likeâ€¦ extremely important.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide7"><p>Likeâ€¦ history-changing levels of important.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide8"><p>Okay maybe not historyâ€¦</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide9"><p>But definitely MY history.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide10"><p>You look really nice today, by the way.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide11"><p>Anywayâ€¦</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide12"><p>You know whatâ€™s coming soon, right?</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide13"><p>The day couples pretend they arenâ€™t broke.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide14"><p>The day flowers suddenly cost triple.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide15"><p>The day hearts are everywhereâ€¦</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide16"><p>Yes, you are right!.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide17"><p>Valentineâ€™s Day.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide18"><p>And of courseâ€¦</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide19"><p>I canâ€™t let that day pass like itâ€™s normal.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide20"><p>Especially when I have someone as special as you.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide21"><p>A regular question just wouldnâ€™t feel right.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide22"><p>Because you deserve something more thoughtful.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide23"><p>So noâ€¦ this isnâ€™t a challenge.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide24"><p>You donâ€™t have to earn anything.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide25"><p>You already mean the world to me.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide26"><p>This mini-gameâ€¦ is just my cute way of asking someone very important to me to spend Valentineâ€™s Day with me.</p><div class="slide-footer">Click hereâ€¦</div></div>
  <div class="slide" id="slide27"><p>So, are you available that day? ğŸ˜Š</p>
    <div class="button-container">
      <button id="yesBtn">YES! ğŸ’–</button>
      <button id="noBtn">NO ğŸ™ƒ</button>
    </div>
  </div>
  <div class="slide" id="slide28"><p>Great! As youâ€™re free that day, please jump into the mini-game ğŸ’–</p>
    <button id="proceedToGame">Proceed to Mini-Game</button>
  </div>
</div>

<div id="floating"></div>

<div class="card" id="gameCard" style="display:none;">
  <h1>Collect 20 hearts to unlock your envelope!</h1>
  <div id="counter">Hearts collected: 0 / 20</div>
</div>

<div class="card" id="envelopeCard" style="display:none;">
  <div id="envelope" class="locked">ğŸ’Œ</div>
  <p>Click to open your Valentine!</p>
</div>

<div class="card" id="valentineCard" style="display:none;">
  <h1>ğŸ’• Camille Anndrea Julgan Lebico, will you be my Valentine? :3</h1>
  <p>-Josh Daz</p>
  <div class="button-container">
    <button id="yesBtnMini">YES! ğŸ’–</button>
    <button id="noBtnMini">NO </button>
  </div>
</div>

<div class="card" id="thankCard" style="display:none;">
  <h1>Thank you so much! </h1>
</div>

<audio id="bgMusic" src="./mata-sa-mata.mp3" loop></audio>
<audio id="heartSound" src="https://orangefreesounds.com/wp-content/uploads/2014/09/Pop-sound-effect.mp3" preload="auto"></audio>
<audio id="yesSound" src="https://www.fesliyanstudios.com/play-mp3/4380" preload="auto"></audio>
<audio id="noSound" src="https://orangefreesounds.com/wp-content/uploads/2021/04/Angry-cat-sound-effect.mp3" preload="auto"></audio>

<script>
const bgm = document.getElementById("bgMusic");
bgm.volume = 0.4;
let musicStarted = false;
function startMusicOnce() {
  if(!musicStarted){
    bgm.currentTime = 12;
    bgm.play().catch(()=>{});
    musicStarted = true;
  }
}

const slides = document.querySelectorAll("#slideshow .slide");
let currentSlide = 0;
function showSlide(index){
  slides.forEach(s=>s.classList.remove("active"));
  slides[index].classList.add("active");
}

function handleSlideClick(){
  startMusicOnce();
  if(currentSlide < 26) {
    currentSlide++;
    showSlide(currentSlide);
  }
}

for(let i=0;i<27;i++){
  slides[i].addEventListener("click",handleSlideClick);
}

document.getElementById("yesBtn").onclick = () => {
  currentSlide = 27;
  showSlide(currentSlide);
};

function setupDodge(btn) {
  const cat = document.createElement("span");
  cat.textContent="ğŸ±";
  cat.style.position="absolute";
  cat.style.fontSize="36px";
  cat.style.top="-38px";
  cat.style.left="50%";
  cat.style.transform="translateX(-50%)";
  btn.style.position="absolute";
  btn.appendChild(cat);

  document.addEventListener("mousemove",(e)=>{
    const rect=btn.getBoundingClientRect();
    if(rect.width > 0) {
        const dx=(rect.left+rect.width/2)-e.clientX;
        const dy=(rect.top+rect.height/2)-e.clientY;
        const distance=Math.sqrt(dx*dx+dy*dy);
        if(distance<200){
          btn.style.left=Math.random()*(window.innerWidth-btn.offsetWidth)+'px';
          btn.style.top=Math.random()*(window.innerHeight-btn.offsetHeight)+'px';
          btn.classList.add("glitch-active");
          document.getElementById("noSound").currentTime=0;
          document.getElementById("noSound").play().catch(()=>{});
          setTimeout(() => btn.classList.remove("glitch-active"), 200);
        }
    }
  });
}

setupDodge(document.getElementById("noBtn"));
setupDodge(document.getElementById("noBtnMini"));

document.getElementById("proceedToGame").addEventListener("click",()=>{
  document.getElementById("slideshow").style.display="none";
  document.getElementById("gameCard").style.display="block";
});

// FLOATING EMOJIS ( increased count to 100 )
const floating = document.getElementById("floating");
const emojis=['ğŸ’–','âœ¨','ğŸŒ¸','ğŸ’Œ','ğŸ±','ğŸ€','ğŸ¬','ğŸŒˆ','ğŸ˜»','ğŸ¶','ğŸ­','ğŸ¦„','ğŸ¥°','ğŸ’'];
for(let i=0;i<100;i++){
  const e=document.createElement('div');
  e.className='floating-emoji';
  e.textContent = emojis[Math.floor(Math.random()*emojis.length)];
  e.style.left=Math.random()*window.innerWidth+'px';
  e.style.bottom=Math.random()*window.innerHeight+'px';
  floating.appendChild(e);

  let posY=parseFloat(e.style.bottom);
  function drift(){
    posY += 1.5;
    e.style.bottom = posY+'px';
    if(posY>window.innerHeight+50) posY=-50;
    requestAnimationFrame(drift);
  }
  drift();
}

let heartsCollected=0;
const totalHearts=20;

function spawnHeart(){
  const heart=document.createElement("div");
  heart.className="heart";
  heart.textContent="ğŸ’–";
  heart.style.left=Math.random()*(window.innerWidth-50)+"px";
  heart.style.top=window.innerHeight + 50 + "px";
  document.body.appendChild(heart);

  let posY=window.innerHeight + 50;
  function driftHeart(){
    posY -= 2.5;
    heart.style.top = posY + 'px';
    if(posY<-100) posY=window.innerHeight+100; 
    if(heart.parentElement) requestAnimationFrame(driftHeart);
  }
  driftHeart();

  heart.addEventListener("click", function(){
    heart.style.animation="heartPop 0.4s forwards";
    document.getElementById("heartSound").currentTime=0; 
    document.getElementById("heartSound").play();
    setTimeout(()=>{
      heartsCollected++;
      document.getElementById("counter").textContent=`Hearts collected: ${heartsCollected} / ${totalHearts}`;
      heart.remove();
      if(heartsCollected>=totalHearts){
        document.getElementById("envelopeCard").style.display="block";
        document.getElementById("gameCard").style.display="none";
        document.getElementById("envelope").classList.remove("locked");
      }
    },400);
  });
}
for(let i=0;i<35;i++) spawnHeart(); // Extra hearts

document.getElementById("envelope").onclick = () => {
    if(!document.getElementById("envelope").classList.contains("locked")){
        document.getElementById("envelopeCard").style.display="none";
        document.getElementById("valentineCard").style.display="block";
    }
};

document.getElementById("yesBtnMini").onclick = () => {
  document.getElementById("yesSound").play();
  document.getElementById("valentineCard").style.display="none";
  document.getElementById("thankCard").style.display="block";
};
</script>
</body>
</html>
